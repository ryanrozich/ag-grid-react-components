# Test info

- Name: Direct Filter Test >> test filter directly without QuickFilterDropdown
- Location: /Users/ryan/code-repos/github/ryanrozich/ag-grid-react-components-worktrees/feat/v2-headless-components/tests/e2e/direct-filter-test.spec.ts:4:3

# Error details

```
Error: expect(received).toBeLessThan(expected)

Expected: < 10001
Received:   10001
    at /Users/ryan/code-repos/github/ryanrozich/ag-grid-react-components-worktrees/feat/v2-headless-components/tests/e2e/direct-filter-test.spec.ts:67:34
```

# Page snapshot

```yaml
- banner:
  - heading "AG Grid React Components" [level=1]
  - navigation:
    - link "Home":
      - /url: /
    - link "Demo":
      - /url: /demo
    - link "Docs":
      - /url: /docs
  - button "Show version details": v0.1.0+48 feat/headless-refactor
  - img
  - text: MIT License
  - link "GitHub":
    - /url: https://github.com/ryanrozich/ag-grid-react-components
    - img
    - text: GitHub
- heading "Project Tasks" [level=1]
- paragraph: Manage and track your team's progress
- navigation:
  - button "Client-Side Data"
  - button "Server-Side DataAPI"
- textbox "Search tasks..."
- img
- button "Quick filter options":
  - text: All Time
  - img
- button "Quick filter options":
  - text: My Views
  - img
- button
- 'button "Due Date: equals Today Remove Due Date filter"':
  - text: "Due Date: equals Today"
  - button "Remove Due Date filter": ×
- button "Clear all filters": Clear all
- img
- paragraph: Number of Tasks
- paragraph: 10,000
- img
- paragraph: Total Budget
- paragraph: $40,772,900
- img
- paragraph: Average Progress
- paragraph: 46.7%
- img
- paragraph: Budget Remaining
- paragraph: $21,673,179
- grid:
  - rowgroup:
    - row "Column with Header Selection Task Status Priority Category Assignee Due Date % Delivered Value Delivered":
      - columnheader "Column with Header Selection":
        - checkbox "Column with Header Selection"
      - columnheader "Task"
      - columnheader "Status"
      - columnheader "Priority"
      - columnheader "Category"
      - columnheader "Assignee"
      - columnheader "Due Date"
      - columnheader "% Delivered"
      - columnheader "Value"
      - columnheader "Delivered"
  - rowgroup:
    - row "Press Space to toggle row selection (unchecked) [AUTH-4892] Create disaster recovery plan (Sprint 27) Todo Medium 🔧 DevOps David Lee David Lee 9/12/2025 5% $8,400 $420":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[AUTH-4892] Create disaster recovery plan (Sprint 27)"
      - gridcell "Todo"
      - gridcell "Medium"
      - gridcell "🔧 DevOps"
      - gridcell "David Lee David Lee":
        - img "David Lee"
        - text: David Lee
      - gridcell "9/12/2025"
      - gridcell "5%"
      - gridcell "$8,400"
      - gridcell "$420"
    - row "Press Space to toggle row selection (unchecked) [MOBILE-6651] Add brute force protection Backlog High 🔒 Security Isabella Garcia Isabella Garcia 9/4/2025 0% $1,375":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[MOBILE-6651] Add brute force protection"
      - gridcell "Backlog"
      - gridcell "High"
      - gridcell "🔒 Security"
      - gridcell "Isabella Garcia Isabella Garcia":
        - img "Isabella Garcia"
        - text: Isabella Garcia
      - gridcell "9/4/2025"
      - gridcell "0%"
      - gridcell "$1,375"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [AUTH-7602] Create troubleshooting guide (Sprint 24) Testing High 📝 Documentation Emma Davis Emma Davis 9/3/2025 93% $925 $860":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[AUTH-7602] Create troubleshooting guide (Sprint 24)"
      - gridcell "Testing"
      - gridcell "High"
      - gridcell "📝 Documentation"
      - gridcell "Emma Davis Emma Davis":
        - img "Emma Davis"
        - text: Emma Davis
      - gridcell "9/3/2025"
      - gridcell "93%"
      - gridcell "$925"
      - gridcell "$860"
    - row "Press Space to toggle row selection (unchecked) [INFRA-2749] Add progressive web app features (Tech Debt) Testing Medium ⚡ Performance Sophia Taylor Sophia Taylor 9/14/2025 94% $14,450 $13,583":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[INFRA-2749] Add progressive web app features (Tech Debt)"
      - gridcell "Testing"
      - gridcell "Medium"
      - gridcell "⚡ Performance"
      - gridcell "Sophia Taylor Sophia Taylor":
        - img "Sophia Taylor"
        - text: Sophia Taylor
      - gridcell "9/14/2025"
      - gridcell "94%"
      - gridcell "$14,450"
      - gridcell "$13,583"
    - row "Press Space to toggle row selection (unchecked) [AUTH-5332] Implement caching strategy In Progress High ⚡ Performance Maya Patel Maya Patel 9/7/2025 31% $6,750 $2,093":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[AUTH-5332] Implement caching strategy"
      - gridcell "In Progress"
      - gridcell "High"
      - gridcell "⚡ Performance"
      - gridcell "Maya Patel Maya Patel":
        - img "Maya Patel"
        - text: Maya Patel
      - gridcell "9/7/2025"
      - gridcell "31%"
      - gridcell "$6,750"
      - gridcell "$2,093"
    - row "Press Space to toggle row selection (unchecked) [BACKEND-5586] Add progressive web app features (Sprint 23) Backlog Low ⚡ Performance Michael Anderson Michael Anderson 9/27/2025 0% $13,525":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[BACKEND-5586] Add progressive web app features (Sprint 23)"
      - gridcell "Backlog"
      - gridcell "Low"
      - gridcell "⚡ Performance"
      - gridcell "Michael Anderson Michael Anderson":
        - img "Michael Anderson"
        - text: Michael Anderson
      - gridcell "9/27/2025"
      - gridcell "0%"
      - gridcell "$13,525"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [APP-7011] Optimize render performance Todo Critical ⚡ Performance Maya Patel Maya Patel 9/1/2025 16% $5,975 $956":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[APP-7011] Optimize render performance"
      - gridcell "Todo"
      - gridcell "Critical"
      - gridcell "⚡ Performance"
      - gridcell "Maya Patel Maya Patel":
        - img "Maya Patel"
        - text: Maya Patel
      - gridcell "9/1/2025"
      - gridcell "16%"
      - gridcell "$5,975"
      - gridcell "$956"
    - row "Press Space to toggle row selection (unchecked) [APP-9738] Create backup automation (Q1 Goals) In Progress Medium 🔧 DevOps Ryan Thomas Ryan Thomas 9/17/2025 35% $1,050 $368":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[APP-9738] Create backup automation (Q1 Goals)"
      - gridcell "In Progress"
      - gridcell "Medium"
      - gridcell "🔧 DevOps"
      - gridcell "Ryan Thomas Ryan Thomas":
        - img "Ryan Thomas"
        - text: Ryan Thomas
      - gridcell "9/17/2025"
      - gridcell "35%"
      - gridcell "$1,050"
      - gridcell "$368"
    - row "Press Space to toggle row selection (unchecked) [MOBILE-1661] Optimize image loading In Progress Low ⚡ Performance John Robinson John Robinson 9/18/2025 26% $4,725 $1,229":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[MOBILE-1661] Optimize image loading"
      - gridcell "In Progress"
      - gridcell "Low"
      - gridcell "⚡ Performance"
      - gridcell "John Robinson John Robinson":
        - img "John Robinson"
        - text: John Robinson
      - gridcell "9/18/2025"
      - gridcell "26%"
      - gridcell "$4,725"
      - gridcell "$1,229"
    - row "Press Space to toggle row selection (unchecked) [API-3676] Fix infinite scroll pagination bug Backlog High 🐛 Bug Ryan Thomas Ryan Thomas 9/1/2025 0% $9,500":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[API-3676] Fix infinite scroll pagination bug"
      - gridcell "Backlog"
      - gridcell "High"
      - gridcell "🐛 Bug"
      - gridcell "Ryan Thomas Ryan Thomas":
        - img "Ryan Thomas"
        - text: Ryan Thomas
      - gridcell "9/1/2025"
      - gridcell "0%"
      - gridcell "$9,500"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [ADMIN-4994] Implement session management Backlog Critical 🔒 Security Amanda White Amanda White 8/30/2025 0% $950":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[ADMIN-4994] Implement session management"
      - gridcell "Backlog"
      - gridcell "Critical"
      - gridcell "🔒 Security"
      - gridcell "Amanda White Amanda White":
        - img "Amanda White"
        - text: Amanda White
      - gridcell "8/30/2025"
      - gridcell "0%"
      - gridcell "$950"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [APP-5451] Optimize render performance In Review Critical ⚡ Performance Amanda White Amanda White 8/31/2025 77% $4,100 $3,157":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[APP-5451] Optimize render performance"
      - gridcell "In Review"
      - gridcell "Critical"
      - gridcell "⚡ Performance"
      - gridcell "Amanda White Amanda White":
        - img "Amanda White"
        - text: Amanda White
      - gridcell "8/31/2025"
      - gridcell "77%"
      - gridcell "$4,100"
      - gridcell "$3,157"
    - row "Press Space to toggle row selection (unchecked) [APP-6219] Debug WebSocket connection timeout (Performance Sprint) In Progress High 🐛 Bug Maya Patel Maya Patel 8/31/2025 24% $18,375 $4,410":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[APP-6219] Debug WebSocket connection timeout (Performance Sprint)"
      - gridcell "In Progress"
      - gridcell "High"
      - gridcell "🐛 Bug"
      - gridcell "Maya Patel Maya Patel":
        - img "Maya Patel"
        - text: Maya Patel
      - gridcell "8/31/2025"
      - gridcell "24%"
      - gridcell "$18,375"
      - gridcell "$4,410"
    - row "Press Space to toggle row selection (unchecked) [PROJ-6459] Add CDN for static assets (Tech Debt) Backlog Medium ⚡ Performance Ryan Thomas Ryan Thomas 9/7/2025 0% $3,400":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[PROJ-6459] Add CDN for static assets (Tech Debt)"
      - gridcell "Backlog"
      - gridcell "Medium"
      - gridcell "⚡ Performance"
      - gridcell "Ryan Thomas Ryan Thomas":
        - img "Ryan Thomas"
        - text: Ryan Thomas
      - gridcell "9/7/2025"
      - gridcell "0%"
      - gridcell "$3,400"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [INFRA-10666] Configure Docker containers (Q2 Planning) Todo Medium 🔧 DevOps Alex Chen Alex Chen 9/12/2025 13% $825 $107":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[INFRA-10666] Configure Docker containers (Q2 Planning)"
      - gridcell "Todo"
      - gridcell "Medium"
      - gridcell "🔧 DevOps"
      - gridcell "Alex Chen Alex Chen":
        - img "Alex Chen"
        - text: Alex Chen
      - gridcell "9/12/2025"
      - gridcell "13%"
      - gridcell "$825"
      - gridcell "$107"
    - row "Press Space to toggle row selection (unchecked) [CORE-3917] Add performance benchmarks Backlog High 🧪 Testing James Wilson James Wilson 8/31/2025 0% $6,500":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[CORE-3917] Add performance benchmarks"
      - gridcell "Backlog"
      - gridcell "High"
      - gridcell "🧪 Testing"
      - gridcell "James Wilson James Wilson":
        - img "James Wilson"
        - text: James Wilson
      - gridcell "8/31/2025"
      - gridcell "0%"
      - gridcell "$6,500"
      - gridcell
    - row "Press Space to toggle row selection (unchecked) [ADMIN-7029] Create troubleshooting guide (Q1 Goals) Todo Low 📝 Documentation Ryan Thomas Ryan Thomas 9/24/2025 14% $700 $98":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[ADMIN-7029] Create troubleshooting guide (Q1 Goals)"
      - gridcell "Todo"
      - gridcell "Low"
      - gridcell "📝 Documentation"
      - gridcell "Ryan Thomas Ryan Thomas":
        - img "Ryan Thomas"
        - text: Ryan Thomas
      - gridcell "9/24/2025"
      - gridcell "14%"
      - gridcell "$700"
      - gridcell "$98"
    - row "Press Space to toggle row selection (unchecked) [BACKEND-8460] Resolve CORS issue with external API Backlog Low 🐛 Bug Isabella Garcia Isabella Garcia 9/11/2025 0% $2,025":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell "[BACKEND-8460] Resolve CORS issue with external API"
      - gridcell "Backlog"
      - gridcell "Low"
      - gridcell "🐛 Bug"
      - gridcell "Isabella Garcia Isabella Garcia":
        - img "Isabella Garcia"
        - text: Isabella Garcia
      - gridcell "9/11/2025"
      - gridcell "0%"
      - gridcell "$2,025"
      - gridcell
  - rowgroup
  - rowgroup
  - rowgroup
  - rowgroup:
    - row "Press Space to toggle row selection (unchecked) $40,772,900 $19,099,721":
      - gridcell "Press Space to toggle row selection (unchecked)":
        - checkbox "Press Space to toggle row selection (unchecked)"
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell "$40,772,900"
      - gridcell "$19,099,721"
  - rowgroup
- tablist:
  - tab "Columns"
  - tab "Filters"
- status: "Rows : 10,000"
- status: "Total Rows : 10,000"
- status
```

# Test source

```ts
   1 | import { test, expect } from "@playwright/test";
   2 |
   3 | test.describe("Direct Filter Test", () => {
   4 |   test("test filter directly without QuickFilterDropdown", async ({ page }) => {
   5 |     page.on("console", (msg) => {
   6 |       if (msg.text().includes("[")) {
   7 |         console.log(msg.text());
   8 |       }
   9 |     });
  10 |
  11 |     await page.goto("/demo");
  12 |     await page.waitForSelector(".ag-root-wrapper");
  13 |     await page.waitForTimeout(1000);
  14 |
  15 |     // Get initial state
  16 |     const initial = await page.evaluate(() => {
  17 |       const api = window.agGridApi;
  18 |       return {
  19 |         rowCount: api?.getDisplayedRowCount(),
  20 |         filterModel: api?.getFilterModel(),
  21 |       };
  22 |     });
  23 |     console.log("Initial state:", initial);
  24 |
  25 |     // Apply filter directly via API
  26 |     const result = await page.evaluate(async () => {
  27 |       const api = window.agGridApi;
  28 |
  29 |       // Set filter model
  30 |       api?.setFilterModel({
  31 |         dueDate: {
  32 |           mode: "relative",
  33 |           type: "equals",
  34 |           expressionFrom: "Today",
  35 |         },
  36 |       });
  37 |
  38 |       // Wait a bit
  39 |       await new Promise((resolve) => setTimeout(resolve, 100));
  40 |
  41 |       // Get filter instance and manually call setModel
  42 |       const filterInstance = await api?.getColumnFilterInstance("dueDate");
  43 |       if (filterInstance && filterInstance.setModel) {
  44 |         await filterInstance.setModel({
  45 |           mode: "relative",
  46 |           type: "equals",
  47 |           expressionFrom: "Today",
  48 |         });
  49 |       }
  50 |
  51 |       // Trigger filter
  52 |       api?.onFilterChanged();
  53 |
  54 |       // Wait for filtering
  55 |       await new Promise((resolve) => setTimeout(resolve, 500));
  56 |
  57 |       return {
  58 |         rowCount: api?.getDisplayedRowCount(),
  59 |         filterModel: api?.getFilterModel(),
  60 |         hasActiveFilter: api?.isAnyFilterPresent(),
  61 |       };
  62 |     });
  63 |
  64 |     console.log("After filter:", result);
  65 |
  66 |     // The filter should have worked
> 67 |     expect(result.rowCount || 0).toBeLessThan(initial.rowCount || 0);
     |                                  ^ Error: expect(received).toBeLessThan(expected)
  68 |     expect(result.hasActiveFilter).toBe(true);
  69 |
  70 |     // Check DOM after more waiting
  71 |     await page.waitForTimeout(1000);
  72 |
  73 |     const domRowCount = await page
  74 |       .locator(".ag-center-cols-container .ag-row")
  75 |       .count();
  76 |     console.log("DOM row count:", domRowCount);
  77 |   });
  78 | });
  79 |
```