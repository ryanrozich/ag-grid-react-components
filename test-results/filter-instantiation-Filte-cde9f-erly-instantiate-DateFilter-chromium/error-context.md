# Test info

- Name: Filter Instantiation Check >> should properly instantiate DateFilter
- Location: /Users/ryan/code-repos/github/ryanrozich/ag-grid-react-components/tests/e2e/filter-instantiation.spec.ts:4:3

# Error details

```
Error: expect(received).toBe(expected) // Object.is equality

Expected: true
Received: false
    at /Users/ryan/code-repos/github/ryanrozich/ag-grid-react-components/tests/e2e/filter-instantiation.spec.ts:120:41
```

# Page snapshot

```yaml
- banner:
  - heading "AG Grid React Components" [level=1]
  - navigation:
    - link "Home":
      - /url: /
    - link "Demo":
      - /url: /demo
    - link "Docs":
      - /url: /docs
  - img
  - text: MIT License
  - link "GitHub":
    - /url: https://github.com/ryanrozich/ag-grid-react-components
    - img
    - text: GitHub
- heading "Project Tasks" [level=1]
- paragraph: Manage and track your team's progress
- textbox "Search tasks..."
- img
- button "Quick filter options":
  - text: All Time
  - img
- button "Quick filter options":
  - text: All Tasks
  - img
- text: "Due Date: Today"
- button "Remove Due Date filter": ×
- button "Clear all filters": Clear all
- img
- paragraph: Number of Tasks
- paragraph: "8"
- img
- paragraph: Total Budget
- paragraph: $37,625
- img
- paragraph: Progress
- paragraph: 40.3%
- img
- paragraph: Budget Remaining
- paragraph: $19,685
- text: 1 to 9 of 9. Page 1 of 1
- grid:
  - rowgroup:
    - row "ID Task Name Category Priority Assignee Due Date Budget Status Progress":
      - columnheader "ID"
      - columnheader "Task Name"
      - columnheader "Category"
      - columnheader "Priority"
      - columnheader "Assignee"
      - columnheader "Due Date"
      - columnheader "Budget"
      - columnheader "Status"
      - columnheader "Progress"
  - rowgroup:
    - row "283 [API-1283] Write migration guide for v2 (Q1 Goals) 📝 Documentation Critical Jessica Lopez Jessica Lopez 6/28/2025 $6,325 Blocked 36%":
      - gridcell "283"
      - gridcell "[API-1283] Write migration guide for v2 (Q1 Goals)"
      - gridcell "📝 Documentation"
      - gridcell "Critical"
      - gridcell "Jessica Lopez Jessica Lopez":
        - img "Jessica Lopez"
        - text: Jessica Lopez
      - gridcell "6/28/2025"
      - gridcell "$6,325"
      - gridcell "Blocked"
      - gridcell "36%"
    - row "486 [INFRA-1486] Document error handling patterns (Q1 Goals) 📝 Documentation Critical John Robinson John Robinson 6/28/2025 $250 In Progress 43%":
      - gridcell "486"
      - gridcell "[INFRA-1486] Document error handling patterns (Q1 Goals)"
      - gridcell "📝 Documentation"
      - gridcell "Critical"
      - gridcell "John Robinson John Robinson":
        - img "John Robinson"
        - text: John Robinson
      - gridcell "6/28/2025"
      - gridcell "$250"
      - gridcell "In Progress"
      - gridcell "43%"
    - row "693 [WEB-1693] Create backup automation 🔧 DevOps High Maya Patel Maya Patel 6/28/2025 $1,500 In Progress 37%":
      - gridcell "693"
      - gridcell "[WEB-1693] Create backup automation"
      - gridcell "🔧 DevOps"
      - gridcell "High"
      - gridcell "Maya Patel Maya Patel":
        - img "Maya Patel"
        - text: Maya Patel
      - gridcell "6/28/2025"
      - gridcell "$1,500"
      - gridcell "In Progress"
      - gridcell "37%"
    - row "271 [APP-1271] Migrate to new testing framework ♻️ Refactor High Michael Anderson Michael Anderson 6/28/2025 $850 In Progress 20%":
      - gridcell "271"
      - gridcell "[APP-1271] Migrate to new testing framework"
      - gridcell "♻️ Refactor"
      - gridcell "High"
      - gridcell "Michael Anderson Michael Anderson":
        - img "Michael Anderson"
        - text: Michael Anderson
      - gridcell "6/28/2025"
      - gridcell "$850"
      - gridcell "In Progress"
      - gridcell "20%"
    - row "293 [PROJ-1293] Split monolithic components (Q1 Goals) ♻️ Refactor Medium James Wilson James Wilson 6/28/2025 $5,250 In Progress 33%":
      - gridcell "293"
      - gridcell "[PROJ-1293] Split monolithic components (Q1 Goals)"
      - gridcell "♻️ Refactor"
      - gridcell "Medium"
      - gridcell "James Wilson James Wilson":
        - img "James Wilson"
        - text: James Wilson
      - gridcell "6/28/2025"
      - gridcell "$5,250"
      - gridcell "In Progress"
      - gridcell "33%"
    - row "457 [USER-1457] Add export to PDF functionality (Tech Debt) ✨ Feature Medium John Robinson John Robinson 6/28/2025 $7,675 Blocked 16%":
      - gridcell "457"
      - gridcell "[USER-1457] Add export to PDF functionality (Tech Debt)"
      - gridcell "✨ Feature"
      - gridcell "Medium"
      - gridcell "John Robinson John Robinson":
        - img "John Robinson"
        - text: John Robinson
      - gridcell "6/28/2025"
      - gridcell "$7,675"
      - gridcell "Blocked"
      - gridcell "16%"
    - row "708 [BACKEND-1708] Add database indexing (Sprint 25) ⚡ Performance Medium Michael Anderson Michael Anderson 6/28/2025 $6,200 Blocked 37%":
      - gridcell "708"
      - gridcell "[BACKEND-1708] Add database indexing (Sprint 25)"
      - gridcell "⚡ Performance"
      - gridcell "Medium"
      - gridcell "Michael Anderson Michael Anderson":
        - img "Michael Anderson"
        - text: Michael Anderson
      - gridcell "6/28/2025"
      - gridcell "$6,200"
      - gridcell "Blocked"
      - gridcell "37%"
    - row "909 [DASH-1909] Set up log aggregation (Security Audit) 🔧 DevOps Low Sarah Johnson Sarah Johnson 6/28/2025 $9,575 Done 100%":
      - gridcell "909"
      - gridcell "[DASH-1909] Set up log aggregation (Security Audit)"
      - gridcell "🔧 DevOps"
      - gridcell "Low"
      - gridcell "Sarah Johnson Sarah Johnson":
        - img "Sarah Johnson"
        - text: Sarah Johnson
      - gridcell "6/28/2025"
      - gridcell "$9,575"
      - gridcell "Done"
      - gridcell "100%"
  - rowgroup
  - rowgroup
  - rowgroup
  - rowgroup:
    - row "$37,625 40%":
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell
      - gridcell "$37,625"
      - gridcell
      - gridcell "40%"
  - rowgroup
- tablist:
  - tab "Columns"
  - tab "Filters"
- status
- status
- status
- text: "Page Size:"
- combobox "Page Size": "25"
- button "First Page" [disabled]: 
- button "Previous Page" [disabled]: 
- text: Page 1 of 1
- button "Next Page" [disabled]: 
- button "Last Page" [disabled]: 
```

# Test source

```ts
   20 |       if (!api) return { error: "No API found" };
   21 |
   22 |       // Get the filter instance
   23 |       const filterInstance = api.getColumnFilterInstance("dueDate");
   24 |
   25 |       // Check if it's a promise
   26 |       const isPromise =
   27 |         filterInstance && typeof filterInstance.then === "function";
   28 |
   29 |       // If it's a promise, try to resolve it
   30 |       if (isPromise) {
   31 |         return filterInstance
   32 |           .then((resolved: any) => {
   33 |             return {
   34 |               isPromise: true,
   35 |               resolvedType: resolved ? resolved.constructor.name : null,
   36 |               hasDoesFilterPass: typeof resolved?.doesFilterPass === "function",
   37 |               hasSetModel: typeof resolved?.setModel === "function",
   38 |               hasGetModel: typeof resolved?.getModel === "function",
   39 |             };
   40 |           })
   41 |           .catch((error: any) => ({
   42 |             isPromise: true,
   43 |             error: error.message,
   44 |           }));
   45 |       }
   46 |
   47 |       return {
   48 |         isPromise: false,
   49 |         instanceType: filterInstance ? filterInstance.constructor.name : null,
   50 |         hasDoesFilterPass: typeof filterInstance?.doesFilterPass === "function",
   51 |         hasSetModel: typeof filterInstance?.setModel === "function",
   52 |         hasGetModel: typeof filterInstance?.getModel === "function",
   53 |       };
   54 |     });
   55 |
   56 |     console.log(
   57 |       "Filter instantiation info:",
   58 |       JSON.stringify(filterInfo, null, 2),
   59 |     );
   60 |
   61 |     // Now try to manually set a filter model
   62 |     const filterResult = await page.evaluate(async () => {
   63 |       const api = window.agGridApi;
   64 |       if (!api) return { error: "No API found" };
   65 |
   66 |       const initialRowCount = api.getDisplayedRowCount();
   67 |
   68 |       // Get the filter instance first
   69 |       const filterInstancePromise = api.getColumnFilterInstance("dueDate");
   70 |       const filterInstance = await filterInstancePromise;
   71 |
   72 |       console.log("Filter instance resolved:", {
   73 |         hasSetModel: typeof filterInstance?.setModel === "function",
   74 |         hasGetModel: typeof filterInstance?.getModel === "function",
   75 |         filterType: filterInstance?.constructor.name,
   76 |       });
   77 |
   78 |       // Set a filter model
   79 |       const filterModel = {
   80 |         mode: "relative",
   81 |         type: "equals",
   82 |         expressionFrom: "Today",
   83 |       };
   84 |
   85 |       // Try setting the model directly on the filter instance
   86 |       if (filterInstance && typeof filterInstance.setModel === "function") {
   87 |         console.log("Calling setModel directly on filter instance");
   88 |         filterInstance.setModel(filterModel);
   89 |       }
   90 |
   91 |       // Also try via the API
   92 |       api.setFilterModel({ dueDate: filterModel });
   93 |       api.onFilterChanged();
   94 |
   95 |       // Wait a bit for the filter to apply
   96 |       return new Promise((resolve) => {
   97 |         setTimeout(() => {
   98 |           const finalRowCount = api.getDisplayedRowCount();
   99 |           const currentFilterModel = api.getFilterModel();
  100 |
  101 |           resolve({
  102 |             initialRowCount,
  103 |             finalRowCount,
  104 |             filterModelSet:
  105 |               JSON.stringify(currentFilterModel) ===
  106 |               JSON.stringify(filterModel),
  107 |             currentFilterModel,
  108 |             wasSetModelCalled: (window as any).setModelWasCalled || false,
  109 |           });
  110 |         }, 1000);
  111 |       });
  112 |     });
  113 |
  114 |     console.log(
  115 |       "Filter application result:",
  116 |       JSON.stringify(filterResult, null, 2),
  117 |     );
  118 |
  119 |     // Check if the filter was actually applied
> 120 |     expect(filterResult.filterModelSet).toBe(true);
      |                                         ^ Error: expect(received).toBe(expected) // Object.is equality
  121 |
  122 |     // The row count should have changed (unless by coincidence all rows match)
  123 |     console.log(
  124 |       `Row count changed from ${filterResult.initialRowCount} to ${filterResult.finalRowCount}`,
  125 |     );
  126 |   });
  127 | });
  128 |
```